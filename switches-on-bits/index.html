<!DOCTYPE html>
<html>
    <head>
        <title>XOR Swap: Hittin' Switches on Bits | schuessler.org</title>
       <link rel="stylesheet" type="text/css" href="http://schuessler.org/tools/stylesheets/rs.css"/> 
    </head>
<body>

<div id="header">XOR Swap: Hittin' Switches on Bits</div>

<a href="../anthropomobi/" title="Anthropomobi"><<</a> | <a href="../anthropomobi/" title="Anthropomobi"><</a> | <a href="http://schuessler.org" title="All posts">home</a> | <a href="http://schuessler.org/switches-on-bits">></a> | <a href="http://schuessler.org/switches-on-bits">>></a>


<p>Now that I have <s>procrastinated enough</s> distinguished zeros from ones in a way that allows them to do some work, it's time to solve the original problem:</p>

<span class="c">Challenge: Swap two numbers in place without using a temporary variable.</span>

<h2>Failed Obi Metaphors</h2>

<p>I had planned to build on the judo metaphor for XOR from <a href="../anthropomobi/">Part 1</a> to show how XOR Swap works. I considered showing a series of duels, with Obis donning fencing masks to represent the intermediate state changes. I suppose I was mainly looking for an excuse to introduce a new hero, "Obi 1":</p>

<div style="font-size:80%; text-align:center;">
  <img src="images/obi.one.jpg" width="270px" class="center">
  <strong>There can be Obi 1</strong>
</div>

<h3><s>Masked Duel</s></h3>
<p>The duel metaphor was a productive in one way: it made it obvious that two zeros would never generate any other combination, no matter how many times we apply XOR:</p>

<img src="images/masked.duel.png" class="center" width="600px">

It didn't generate much insight into the other three cases, though, and still required almost as much mental accounting as the original Wikipedia explanation, so I abandoned it.

<h3><s>Battery</s></h3>
<p>I also tried out and rejected a kind of Obi battery &#8212; ("Maybe the only state that can generate current has both positive and ground terminals? That's not quite right..."):</p>

<img src="images/obi.battery.png" class="center" width="200px">


<h3><s>Icarus</s></h3>
<p>I then imagined a kind of Icarus scenario, where multiple ones lead to some kind of hubristic failure and a return to earth:</p>

<img src="images/icarus.png" class="center" width="600px">

<p>I like this one for its poetry, but the metaphor is still not quite right.</p>

<h3>Fibonacci</h3>
<p>A novel way of looking at what happens with XOR Swap is to create a Fibonacci-like sequence where each bit is the output of XOR applied to the two previous bits. This perspective is promising.</p>

<img src="images/obi.fib.png" class="center" width="200px">

<p>The zeros do nothing. All three of the other configurations recur like the bommm-bop-bop of a waltz or the stomp-stomp-clap of "We Will Rock You", depending on where you start. This simplifies things a great deal! Now there are just two outcomes: nothing happening if we start with all zeros, or the same repeating sequence for all three other start states.</p>


<h3>Switch!</h3>

<img src="images/obi.switch.png" class="center" width="270px">

<p>I like the switch metaphor! It explains each of the four original cases, and even lets us extend our intuition beyond two inputs. The start state of the toggle is off:</p>

<table width="80%">
  <tr>
    <th>input</th>
    <th>result</th>
  </tr>
  <tr>
    <td>0 &#8853; 0</td>
    <td>Two nobis standing around doing nothing; nothing happens, the button stays off.</td>
  </tr>
  <tr>
    <td>1 &#8853; 0</td>
    <td>A single yobi hits the switch; it stays on.</td>
  </tr>
  <tr>
    <td>0 &#8853; 1</td>
    <td>Same as above.</td>
  </tr>
  <tr>
    <td>1 &#8853; 1</td>
    <td>Both yobis hit the switch, turning it on, then immediately back off.</td>
  </tr>
  <tr>
    <td>1 &#8853; 0 &#8853; 1 &#8853; 1 &#8853; 0 ...</td>
    <td>What if we have more than two? XOR tests whether the sum is odd.</td>
  </tr>
</table>

<p>XOR, like the Fibonacci sequence, is a kind of addition. If you start with zeros, you will only get zeros. If you start with one or more ones, you get a cycle with two states &#8212; count up to one, then start over.</p>

<p>Playing with obis and XOR gives me several new perspectives:</p>

<ul>
  <li>XOR is its own inverse!</li>
  <li>XOR is equivalent to addition mod 2</li>
  <li>XOR tests whether the sum of bits is odd</li>
  <li>This one's not new: Keep learning math! Everyone who has been exposed to group theory probably thinks this is all obvious</li>
</ul>

<p>One consequence of this line of thinking is that, whatever the origin of its design, the symbol for XOR now seems deeply meaningful:</p>

<div class="c bigger" > &#8853;</div>

<p>XOR is addition mod 2: addition, in a circle.</p>

<p>The original challenge was to Swap two numbers in place without using a temporary variable. With help from anthropomobi and the switch metaphor, I can solve the problem using XOR Swap as originally proposed, but with a deeper understanding of why it works:</p>

<ul class="code">
  <li class="no-bullet">x ^= y</li>
  <li class="no-bullet">y ^= x</li>
  <li class="no-bullet">x ^= y</li>
</ul>

<p>And of course there's an easy way to do this in Python via tuple unpacking:</p>

<ul class="code">
  <li class="no-bullet">y, x = x, y</p></li>
</ul>

<img src="images/obi.wings.png" width="100px" class="center">

<p></p>
<hr size="1px">

<a href="../anthropomobi/" title="Anthropomobi"><<</a> | <a href="../anthropomobi/" title="Anthropomobi"><</a> | <a href="http://schuessler.org" title="All posts">home</a> | <a href="http://schuessler.org/switches-on-bits">></a> | <a href="http://schuessler.org/switches-on-bits">>></a>

</body>
</html>
